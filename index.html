<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bybit User Data Lookup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
        }
        .card-gradient {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        }
        .result-card {
            transition: all 0.3s ease;
        }
        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-12">
            <div class="flex justify-center items-center mb-4">
                <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mr-3">
                    <i class="fas fa-chart-line text-white text-xl"></i>
                </div>
                <h1 class="text-4xl font-bold text-white">Bybit User Data Lookup</h1>
            </div>
            <p class="text-lg text-blue-200">Enter your Bybit UID to retrieve account information and trading data</p>
        </header>

        <!-- Main Content -->
        <div class="max-w-4xl mx-auto">
            <!-- Search Card -->
            <div class="card-gradient rounded-2xl shadow-2xl p-8 mb-8">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Find Your Bybit Data</h2>
                    <p class="text-gray-600">Enter your unique Bybit UID to access your trading information</p>
                </div>

                <!-- Search Form -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-user-circle mr-2 text-blue-500"></i>
                            Bybit UID
                        </label>
                        <input 
                            type="number" 
                            id="uidInput" 
                            placeholder="Enter your Bybit UID (e.g., 485218082)" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"
                        >
                    </div>

                    <div class="flex gap-4">
                        <button 
                            onclick="searchByUID()" 
                            class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-3 px-6 rounded-xl transition duration-200 font-semibold flex items-center justify-center"
                        >
                            <i class="fas fa-search mr-2"></i>
                            Search User Data
                        </button>
                        <button 
                            onclick="loadSampleData()" 
                            class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 px-6 rounded-xl transition duration-200 font-semibold flex items-center justify-center"
                        >
                            <i class="fas fa-eye mr-2"></i>
                            View Sample Data
                        </button>
                    </div>
                </div>

                <!-- Quick Examples -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2 flex items-center">
                        <i class="fas fa-lightbulb mr-2"></i>
                        Quick Test UIDs:
                    </h4>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="setUID(485218082)" class="text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-2 rounded-lg transition duration-150">
                            UID: 485218082
                        </button>
                        <button onclick="setUID(485218083)" class="text-sm bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded-lg transition duration-150">
                            UID: 485218083
                        </button>
                        <button onclick="setUID(485218084)" class="text-sm bg-purple-100 hover:bg-purple-200 text-purple-700 px-3 py-2 rounded-lg transition duration-150">
                            UID: 485218084
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsSection" class="hidden">
                <!-- User Found -->
                <div id="userFound" class="hidden">
                    <!-- User Summary -->
                    <div class="card-gradient rounded-2xl shadow-2xl p-6 mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">
                                    <i class="fas fa-user-check text-green-500 mr-2"></i>
                                    User Found
                                </h3>
                                <p class="text-gray-600" id="userSummary">UID: <span id="foundUID"></span></p>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold text-green-600" id="kycLevel"></div>
                                <div class="text-sm text-gray-500">KYC Level</div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Data Card -->
                    <div class="card-gradient rounded-2xl shadow-2xl p-6 mb-6 result-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-database text-blue-500 mr-2"></i>
                            User Data Overview
                        </h3>
                        <div id="userData" class="space-y-4"></div>
                    </div>

                    <!-- Trading Statistics -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-white rounded-xl shadow-lg p-4 text-center">
                            <div class="text-2xl font-bold text-blue-600" id="depositAmount">0</div>
                            <div class="text-sm text-gray-600 mt-1">Deposits (USDT)</div>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-4 text-center">
                            <div class="text-2xl font-bold text-green-600" id="tradingAmount">0</div>
                            <div class="text-sm text-gray-600 mt-1">Trading Amount</div>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-4 text-center">
                            <div class="text-2xl font-bold text-purple-600" id="feeProfit">0</div>
                            <div class="text-sm text-gray-600 mt-1">Fee Profit</div>
                        </div>
                        <div class="bg-white rounded-xl shadow-lg p-4 text-center">
                            <div class="text-2xl font-bold text-orange-600" id="commissions">0</div>
                            <div class="text-sm text-gray-600 mt-1">Commissions</div>
                        </div>
                    </div>

                    <!-- Raw JSON Data -->
                    <div class="card-gradient rounded-2xl shadow-2xl p-6 result-card">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-code text-gray-500 mr-2"></i>
                            Complete Data
                        </h3>
                        <pre id="rawData" class="bg-gray-800 text-green-400 p-4 rounded-lg overflow-x-auto text-sm"></pre>
                    </div>
                </div>

                <!-- User Not Found -->
                <div id="userNotFound" class="hidden card-gradient rounded-2xl shadow-2xl p-8 text-center">
                    <div class="text-6xl text-yellow-500 mb-4">
                        <i class="fas fa-user-slash"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">User Not Found</h3>
                    <p class="text-gray-600 mb-4">The UID you entered doesn't exist in our database.</p>
                    <div class="space-y-2 text-sm text-gray-500">
                        <p>• Please check that you entered the correct UID</p>
                        <p>• Make sure the UID is registered in our system</p>
                        <p>• Try using one of the sample UIDs above for testing</p>
                    </div>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden card-gradient rounded-2xl shadow-2xl p-8 text-center">
                    <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"></div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Searching Database</h3>
                    <p class="text-gray-600">Looking up user information...</p>
                </div>
            </div>

            <!-- Sample Data Preview -->
            <div id="samplePreview" class="card-gradient rounded-2xl shadow-2xl p-6 mt-8">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                    About This System
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-700 mb-2">Data Sources</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Real-time Google Sheets data</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Bybit trading information</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>User engagement metrics</li>
                            <li><i class="fas fa-check text-green-500 mr-2"></i>Financial statistics</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-700 mb-2">Available Information</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><i class="fas fa-chart-bar text-blue-500 mr-2"></i>Trading volumes & amounts</li>
                            <li><i class="fas fa-money-bill-wave text-green-500 mr-2"></i>Deposit history</li>
                            <li><i class="fas fa-percentage text-purple-500 mr-2"></i>Fee structures</li>
                            <li><i class="fas fa-calendar-alt text-orange-500 mr-2"></i>Account timeline</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 text-center">
            <p class="text-blue-200 text-sm">
                <i class="fas fa-shield-alt mr-2"></i>
                Secure Bybit Data Lookup System • Connected to Google Sheets Database
            </p>
        </footer>
    </div>

    <script>
        const scriptUrl = 'https://script.google.com/macros/s/AKfycbzf7Faa_Iuqx17TJ-Ok98-1v_Y4hXnnIGHt1XjxszVzb9SMjgIEWx4xVF6VEE9L7by6/exec';
        let allUserData = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
        });

        // Load all data from Google Sheets
        async function loadAllData() {
            try {
                const response = await fetch(scriptUrl);
                allUserData = await response.json();
                console.log('Loaded user data:', allUserData);
            } catch (error) {
                console.error('Error loading data:', error);
                // Load sample data if live data fails
                loadSampleDataset();
            }
        }

        // Search by UID
        async function searchByUID() {
            const uidInput = document.getElementById('uidInput').value.trim();
            
            if (!uidInput) {
                alert('Please enter a Bybit UID');
                return;
            }

            showLoading();

            // Wait a moment for visual feedback
            setTimeout(async () => {
                try {
                    // If we don't have data yet, try to load it
                    if (allUserData.length === 0) {
                        await loadAllData();
                    }

                    const uid = parseInt(uidInput);
                    const user = allUserData.find(u => u.UID === uid);

                    if (user) {
                        displayUserData(user);
                    } else {
                        showUserNotFound();
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    // Fallback to sample data search
                    searchInSampleData(uidInput);
                }
            }, 1000);
        }

        // Display user data
        function displayUserData(user) {
            hideLoading();
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('userFound').classList.remove('hidden');
            document.getElementById('userNotFound').classList.add('hidden');

            // Update summary
            document.getElementById('foundUID').textContent = user.UID;
            document.getElementById('kycLevel').textContent = user['KYC(Lv.)'] || '0';

            // Update stats
            document.getElementById('depositAmount').textContent = formatNumber(user['Deposits Amount'] || 0);
            document.getElementById('tradingAmount').textContent = formatNumber(user['TradingAmount'] || 0);
            document.getElementById('feeProfit').textContent = formatNumber(user['Fee Profit'] || 0);
            document.getElementById('commissions').textContent = formatNumber(user['Commissions'] || 0);

            // Display detailed data
            const userDataDiv = document.getElementById('userData');
            userDataDiv.innerHTML = createUserDataHTML(user);

            // Display raw JSON
            document.getElementById('rawData').textContent = JSON.stringify(user, null, 2);
        }

        // Create HTML for user data display
        function createUserDataHTML(user) {
            const fields = [
                { label: 'VIP Level', value: user['VIP Level'] || 'Not Set', icon: 'crown', color: 'text-yellow-600' },
                { label: 'User Engagement', value: user['User engagement'] || 'Unknown', icon: 'activity', color: 'text-green-600' },
                { label: 'Joined Bybit', value: formatDate(user['Joined Bybit']), icon: 'calendar', color: 'text-blue-600' },
                { label: 'Source', value: user['Source'] || 'Unknown', icon: 'source', color: 'text-purple-600' },
                { label: 'Coin', value: user['Coin'] || 'USDT', icon: 'coins', color: 'text-yellow-500' },
                { label: 'First-Time Deposited', value: user['First-Time Deposited'] || 'Not Yet', icon: 'download', color: 'text-green-500' },
                { label: 'Taker Amount', value: formatNumber(user['TakerAmount'] || 0), icon: 'arrow-up', color: 'text-red-500' },
                { label: 'Maker Amount', value: formatNumber(user['MakerAmount'] || 0), icon: 'arrow-down', color: 'text-blue-500' },
                { label: 'Interest', value: formatNumber(user['Interest'] || 0), icon: 'percent', color: 'text-purple-500' },
                { label: 'Tradfi Amount', value: formatNumber(user['Tradfi Amount'] || 0), icon: 'exchange-alt', color: 'text-orange-500' },
                { label: 'Rebate Coin', value: user['Rebate Coin'] || 'USDT', icon: 'gift', color: 'text-pink-500' }
            ];

            return fields.map(field => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center">
                        <i class="fas fa-${field.icon} ${field.color} mr-3"></i>
                        <div>
                            <div class="font-semibold text-gray-700">${field.label}</div>
                            <div class="text-sm text-gray-500">${field.value}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Show user not found
        function showUserNotFound() {
            hideLoading();
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('userFound').classList.add('hidden');
            document.getElementById('userNotFound').classList.remove('hidden');
        }

        // Show loading state
        function showLoading() {
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('userFound').classList.add('hidden');
            document.getElementById('userNotFound').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
        }

        // Hide loading state
        function hideLoading() {
            document.getElementById('loadingState').classList.add('hidden');
        }

        // Set UID from quick examples
        function setUID(uid) {
            document.getElementById('uidInput').value = uid;
        }

        // Load sample data for demonstration
        function loadSampleData() {
            const sampleUser = {
                "UID": 485218082,
                "VIP Level": "VIP 1",
                "User engagement": "Above 180",
                "Joined Bybit": "2025-07-04T03:43:26.000Z",
                "Source": "CSTAPPTELEGR",
                "Remarks": "Active Trader",
                "KYC(Lv.)": 1,
                "Coin": "USDT",
                "First-Time Deposited": "2025-07-05",
                "Deposits Amount": 1500,
                "TradingAmount": 12500,
                "TakerAmount": 8000,
                "MakerAmount": 4500,
                "Interest": 25.50,
                "Fee Profit": 45.75,
                "Commissions": 12.30,
                "Tradfi Amount": 3200,
                "Rebate Coin": "USDT"
            };
            
            setUID(sampleUser.UID);
            displayUserData(sampleUser);
        }

        // Sample dataset for fallback
        function loadSampleDataset() {
            allUserData = [
                {
                    "UID": 485218082,
                    "VIP Level": "VIP 1",
                    "User engagement": "Above 180",
                    "Joined Bybit": "2025-07-04T03:43:26.000Z",
                    "Source": "CSTAPPTELEGR",
                    "Remarks": "Active Trader",
                    "KYC(Lv.)": 1,
                    "Coin": "USDT",
                    "First-Time Deposited": "2025-07-05",
                    "Deposits Amount": 1500,
                    "TradingAmount": 12500,
                    "TakerAmount": 8000,
                    "MakerAmount": 4500,
                    "Interest": 25.50,
                    "Fee Profit": 45.75,
                    "Commissions": 12.30,
                    "Tradfi Amount": 3200,
                    "Rebate Coin": "USDT"
                },
                {
                    "UID": 485218083,
                    "VIP Level": "",
                    "User engagement": "Below 90",
                    "Joined Bybit": "2025-08-10T10:20:15.000Z",
                    "Source": "WEB",
                    "Remarks": "New User",
                    "KYC(Lv.)": 0,
                    "Coin": "USDT",
                    "First-Time Deposited": "",
                    "Deposits Amount": 0,
                    "TradingAmount": 0,
                    "TakerAmount": 0,
                    "MakerAmount": 0,
                    "Interest": 0,
                    "Fee Profit": 0,
                    "Commissions": 0,
                    "Tradfi Amount": 0,
                    "Rebate Coin": "USDT"
                }
            ];
        }

        // Search in sample data (fallback)
        function searchInSampleData(uidInput) {
            const uid = parseInt(uidInput);
            const user = allUserData.find(u => u.UID === uid);
            
            if (user) {
                displayUserData(user);
            } else {
                showUserNotFound();
            }
        }

        // Utility functions
        function formatNumber(num) {
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(num);
        }

        function formatDate(dateString) {
            if (!dateString) return 'Unknown';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } catch {
                return dateString;
            }
        }

        // Enter key support
        document.getElementById('uidInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchByUID();
            }
        });
    </script>
</body>
</html>
